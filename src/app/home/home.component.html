@if (!loading) {
    <div style="padding: 1rem;"> 
        <h2> <i class="fa-solid fa-user"></i> Welcome, {{user.username}}!</h2>
    </div>
    

    <!-- Default items -->
     <div class="tables-container">

    @if (user.role == 'TEACHER') {
        <p-table [value]="students">
            <ng-template #caption>
                <i class="fa-solid fa-users"></i>
                &nbsp;
                <p-badge value="My students" severity="secondary"></p-badge>
            </ng-template>
            <ng-template #header>
                <tr>
                    <th>Id</th>
                    <th>Name</th>
                    <th>Role</th>
                    <th></th>
                </tr>
            </ng-template>
            <ng-template #body let-student>
                <tr>
                    <td>{{student.id}}</td>

                    <td>{{student.username}}</td>
                    <td>
                        <p-badge value="{{student.role}}" severity="success"></p-badge>
                    </td>
                    <td>
                        <div style="display: flex; gap: 0.5rem;">
                            <p-button icon="fa-solid fa-xmark" tooltipPosition="left" pTooltip="Remove this student"></p-button>
                        </div>
                        
                    </td>
                </tr>
            </ng-template>
            <ng-template #emptymessage>
                <tr>
                    <td colspan="4">No students found.</td>
                </tr>
            </ng-template>
        </p-table>
    } @else if (user.role == 'STUDENT') {
        <p-table [value]="gameSessions">
            <ng-template #caption>
                <i class="fa-solid fa-gamepad"></i>
                &nbsp;
                <p-badge value="My game sessions" severity="secondary"></p-badge>
            </ng-template>
            <ng-template #header>
                <tr>
                    <th>Id</th>
                    <th>Type</th>
                    <th>Completed</th>
                    <th>Score</th>
                    <th>Actions</th>
                </tr>
            </ng-template>
            <ng-template #body let-gamesession>
                <tr>
                    <td>{{gamesession.id}}</td>
                    <td>{{gamesession.gameType}}</td>
                    <td>{{gamesession.completed}}</td>
                    <td>
                        {{gamesession.score}}
                    </td>
                    <td>
                        <p-button (click)="playGame(gamesession.id)">Play now!</p-button>
                        <p-button severity="info">Restart</p-button>
                    </td>
                </tr>
            </ng-template>
            <ng-template #emptymessage>
                <tr>
                    <td colspan="4">No game sessions found.</td>
                </tr>
            </ng-template>
        </p-table>

        <p-table [value]="teachers">
            <ng-template #caption>
                <i class="fa-solid fa-users"></i>
                &nbsp;
                <p-badge value="My teachers" severity="secondary"></p-badge>
            </ng-template>
            <ng-template #header>
                <tr>
                    <th>Id</th>
                    <th>Name</th>
                    <th>Role</th>
                </tr>
            </ng-template>
            <ng-template #body let-teacher>
                <tr>
                    <td>{{teacher.id}}</td>

                    <td>{{teacher.username}}</td>
                    <td>
                        <p-badge value="{{teacher.role}}" severity="success"></p-badge>
                    </td>
                </tr>
            </ng-template>
            <ng-template #emptymessage>
                <tr>
                    <td colspan="4">No teachers found.</td>
                </tr>
            </ng-template>
        </p-table>
    }

    <p-table [value]="studySets">
        <ng-template #caption>
            <i class="fa-solid fa-graduation-cap"></i>
            &nbsp;
            <p-badge value="My study sets" severity="secondary"></p-badge>
        </ng-template>
        <ng-template #header>
            <tr>
                <th>Id</th>
                <th>Title</th>
                <th>Description</th>
                <th>Questions</th>
                <th></th>
            </tr>
        </ng-template>
        <ng-template #body let-set>
            <tr>
                <td>{{set.id}}</td>

                <td>{{set.title}}</td>

                <td>{{set.description}}</td>
                
                <td> {{set.questions.length}} </td>

                <td> 
                    <div style="display: flex; gap:0.5rem">
                        <p-button icon="fa-solid fa-file-arrow-down" severity="secondary" (click)="downloadSet(set)" pTooltip="Download to JSON"></p-button> 
                        <p-button icon="fa-solid fa-pen-to-square" (click)="editStudySet(set)" pTooltip="Edit this set"></p-button>
                    </div>
                </td>
            </tr>
        </ng-template>
        <ng-template #footer>
            <tr> 
                <td colspan="6"> 
                        <p-button (click)="createStudySet()" icon="fa-solid fa-plus" pTooltip="Create new study set"></p-button>
                </td>
            </tr>
            @if (creatingNew) {
                <tr>  
                    <td colspan="6"> 
                        <input pInputText [(ngModel)]="newStudySet.title" type="text" placeholder="Title" />
                        <input pInputText [(ngModel)]="newStudySet.description" type="text" placeholder="Description" />
                        <p-button (click)="saveStudySet()" icon="fa-solid fa-save" pTooltip="Save new study set"></p-button>
                    </td>
                </tr>
            }

        </ng-template>
        <ng-template #emptymessage>
            <tr>
                <td colspan="5">No study sets found.</td>
            </tr>
        </ng-template>
    </p-table>
    
</div>
}